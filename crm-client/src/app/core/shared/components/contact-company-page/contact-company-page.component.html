<div class="page-container tw-m-[15px]">
  <div class="tw-flex">
    <div class="tw-justify-between tw-w-full tw-grid tw-items-center">
      <app-base-label
        [label]="'Company'"
        *ngIf="module === 'COMP'"
      ></app-base-label>
      <app-base-label
        [label]="'Contact'"
        *ngIf="module === 'CONT'"
      ></app-base-label>
    </div>
    <div class="action-div tw-flex">
      <p-button
        [icon]="'pi pi-upload'"
        rounded="true"
        [text]="true"
        [pTooltip]="'Export'"
        (onClick)="exportFile(dt.processedData)"
      ></p-button>
      <p-button
        [icon]="'pi pi-download'"
        rounded="true"
        [text]="true"
        [pTooltip]="'Import'"
        (onClick)="importFile()"
      ></p-button>
      <p-button
        [icon]="'pi pi-plus'"
        rounded="true"
        [text]="true"
        [pTooltip]="'Create'"
        (onClick)="toCreate()"
      ></p-button>
    </div>
  </div>

  <p-dialog
    header="Create Contact"
    [(visible)]="displayCreateDialog"
    [style]="{ width: '70%' }"
  >
    <app-base-form [formConfig]="createFormConfig"></app-base-form>
    <ng-template pTemplate="footer"> </ng-template>
  </p-dialog>

  <p-tabView class="">
    <p-tabPanel header="Contact" [selected]="true" [closable]="true">
      <p-table
        #dt
        [columns]="tableConfig"
        [value]="contactList"
        [(selection)]="selectedContact"
        [resizableColumns]="true"
        styleClass="p-datatable-gridlines p-datatable-striped"
        class="contact-company-table"
      >
        <ng-template pTemplate="caption">
          <div class="tw-flex tw-items-center tw-justify-end">
            <p-button
              icon="pi pi-trash"
              [rounded]="true"
              [text]="true"
              (onClick)="delete()"
            />
          </div>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th><p-tableHeaderCheckbox /></th>
            <th *ngFor="let item of columns" pSortableColumn="{{ item.code }}">
              <div *ngIf="item.code !== 'contactProfilePhotoUrl'">
                {{ item.header }} <p-sortIcon field="{{ item.code }}" />
              </div>
              <div *ngIf="item.code === 'contactProfilePhotoUrl'"></div>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-contact let-columns="columns">
          <tr>
            <td><p-tableCheckbox [value]="contact" /></td>
            <td *ngFor="let col of columns">
              <div *ngIf="col.code === 'contactProfilePhotoUrl'">
                <p-avatar
                  *ngIf="contact[col.code]"
                  [image]="contact[col.code]"
                  shape="circle"
                ></p-avatar>
                <p-avatar
                  *ngIf="!contact[col.code]"
                  [icon]="'pi pi-user'"
                  shape="circle"
                ></p-avatar>
              </div>

              <div *ngIf="col.code !== 'contactProfilePhotoUrl'">
                <div
                  *ngIf="
                    col.code === 'contactFirstName' ||
                    col.code === 'contactLastName'
                  "
                >
                  <p-button
                    [label]="contact[col.code]"
                    [text]="true"
                    [pTooltip]="contact[col.code]"
                    (onClick)="toProfile(contact)"
                  ></p-button>
                </div>
                <div
                  *ngIf="
                    col.code !== 'contactFirstName' &&
                    col.code !== 'contactLastName' &&
                    col.code !== 'createdDate' &&
                    col.code !== 'modifiedDate'
                  "
                  [pTooltip]="contact[col.code]"
                >
                  {{ contact[col.code] }}
                </div>
                <div
                  *ngIf="
                    col.code === 'createdDate' || col.code === 'modifiedDate'
                  "
                  [pTooltip]="contact[col.code]"
                >
                  {{ convertDateFormat(contact[col.code]) }}
                </div>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabPanel>
  </p-tabView>
</div>
